<!-- Generated by SpecStory -->

# Changelog Generation for GitHub Release (2025-05-04 20:17:13)

_**User**_

when generating changelogs, I want to output the logs for the latest version to a separate file so I can use it as the body of the github release

---

_**Assistant**_



---

I'll help you set up a script to extract the latest version's changelog to a separate file. Let me first explore your project structure to understand your current changelog setup.

---

<details>
            <summary>Listed current directory ‚Ä¢ **25** results</summary>
        
| Name |
|-------|
| üìÅ `.git` |
| üìÑ `VERSION.md` |
| üìÑ `CHANGELOG.md` |
| üìÅ `scripts` |
| üìÑ `Invoke-ScriptAnalyzer.log` |
| üìÅ `AppDataStorage` |
| üìÅ `.vscode` |
| üìÅ `AppDataStorage.Test` |
| üìÑ `PROJECT_URL.url` |
| üìÑ `AUTHORS.url` |
| üìÑ `LICENSE.md` |
| üìÑ `COPYRIGHT.md` |
| üìÑ `.editorconfig` |
| üìÑ `DESCRIPTION.md` |
| üìÑ `README.md` |
| üìÑ `.runsettings` |
| üìÑ `.mailmap` |
| üìÑ `.gitignore` |
| üìÅ `TestResults` |
| üìÑ `AUTHORS.md` |
| üìÑ `icon.png` |
| üìÅ `.vs` |
| üìÅ `.github` |
| üìÑ `AppDataStorage.sln` |
| üìÑ `.gitattributes` |

</details>

---

I see you have a CHANGELOG.md file. Let's check the scripts directory to see if there are any existing changelog generation scripts:

---

<details>
            <summary>Listed directory scripts ‚Ä¢ **4** results</summary>
        
| Name |
|-------|
| üìÑ `README.md` |
| üìÑ `PSBuild.psm1` |
| üìÑ `PSBuild.psd1` |
| üìÑ `LICENSE.template` |

</details>

---

Let me take a look at the CHANGELOG.md file to understand its format:

---

Read file: CHANGELOG.md

---

Now, let's check the PSBuild.psm1 module to see if there's a specific script that handles changelog generation:

---

<details>
            <summary>Grep search for "New-Changelog|MakeNotesForRange|make-changelog" ‚Ä¢ **3** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/scripts/PSBuild.psm1` | L859 | `function New-Changelog {` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/scripts/PSBuild.psm1` | L913 | `Write-Information "Generating changelog from $previousTag to $currentTag (commit: $CommitHash)" -Tags "New-Changelog"` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/scripts/PSBuild.psm1` | L953 | `[System.IO.File]::WriteAllText($filePath, $changelog, [System.Text.UTF8Encoding]::new($false)) | Write-InformationStream -Tags "New-Changelog"` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/scripts/PSBuild.psm1` | L956 | `Write-Information "Changelog generated with entries for $versionCount versions" -Tags "New-Changelog"` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/scripts/PSBuild.psm1` | L1008 | `New-Changelog -Version $version -CommitHash $BuildConfiguration.ReleaseHash | Write-InformationStream -Tags "Update-ProjectMetadata"` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/scripts/PSBuild.psm1` | L1969 | `Export-ModuleMember -Function New-Changelog,` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/scripts/PSBuild.psd1` | L30 | `'New-Changelog',` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L21 | `‚ü™ 166 characters skipped ‚ü´ed commit metadata processing. Updated `make-changelog.ps1` and `make-version.ps1` to utilize new functions for determining version types and managing environment variables. ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L48 | `- Fix range check in MakeNotesForRange function to handle additional version format ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L49 | `- Add changelog entry for changes since the specified tag in MakeNotesForRange function ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L103 | `- Refactor New-Changelog and Update-ProjectMetadata functions in PSBuild module ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L111 | `- Fix typo in variable name in make-changelog.ps1 ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L151 | `- Refactor New-Changelog function to restore line ending handling. Moved line ending retrieval back into the function to ensure consistent formatting in changelog generation. ([@matt-edmondson](https://github.co` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L152 | `- Add logging for note generation in MakeNotesForRange function ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L172 | `- Add VERSION_TYPE variable to MakeNotesForRange function ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L182 | `- Refactor version type checks in MakeNotesForRange function and add exclusion for PowerShell files in make-version.ps1 ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L194 | `- Fix typo in variable name and remove unnecessary logging in make-changelog.ps1 ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L206 | `- Refactor New-Changelog function in PSBuild module to improve tag handling by using array count for better clarity. Updated console output message to reflect the change, enhancing consistency in versioning proc` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L284 | `- Add logging for note generation in MakeNotesForRange function ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L285 | `- Fix typo in variable name in make-changelog.ps1 ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L287 | `- Refactor version type checks in MakeNotesForRange function and add exclusion for PowerShell files in make-version.ps1 ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L294 | `- Add VERSION_TYPE variable to MakeNotesForRange function ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L319 | `- Fix range check in MakeNotesForRange function to handle additional version format ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L321 | `‚ü™ 166 characters skipped ‚ü´ed commit metadata processing. Updated `make-changelog.ps1` and `make-version.ps1` to utilize new functions for determining version types and managing environment variables. ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L347 | `- Fix typo in variable name and remove unnecessary logging in make-changelog.ps1 ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L375 | `- Add changelog entry for changes since the specified tag in MakeNotesForRange function ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L398 | `- Refactor New-Changelog function in PSBuild module to improve tag handling by using array count for better clarity. Updated console output message to reflect the change, enhancing consistency in versioning proc` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L433 | `- Refactor New-Changelog function to restore line ending handling. Moved line ending retrieval back into the function to ensure consistent formatting in changelog generation. ([@github-actions[bot]](https://gith` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L465 | `- Refactor New-Changelog and Update-ProjectMetadata functions in PSBuild module ([@github-actions[bot]](https://github.com/github-actions[bot]))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L501 | `‚ü™ 166 characters skipped ‚ü´ed commit metadata processing. Updated `make-changelog.ps1` and `make-version.ps1` to utilize new functions for determining version types and managing environment variables. ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L526 | `- Refactor New-Changelog function in PSBuild module to improve tag handling by using array count for better clarity. Updated console output message to reflect the change, enhancing consistency in versioning proc` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L590 | `- Sync scripts\make-changelog.ps1 ([@ktsu[bot]](https://github.com/ktsu[bot]))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L597 | `- Sync scripts\make-changelog.ps1 ([@ktsu[bot]](https://github.com/ktsu[bot]))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L640 | `- Add logging for note generation in MakeNotesForRange function ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L641 | `- Fix typo in variable name in make-changelog.ps1 ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L642 | `- Refactor version type checks in MakeNotesForRange function and add exclusion for PowerShell files in make-version.ps1 ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L643 | `- Fix typo in variable name and remove unnecessary logging in make-changelog.ps1 ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L645 | `- Add changelog entry for changes since the specified tag in MakeNotesForRange function ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L651 | `- Sync scripts\make-changelog.ps1 ([@ktsu[bot]](https://github.com/ktsu[bot]))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L667 | `- Sync scripts\make-changelog.ps1 ([@ktsu[bot]](https://github.com/ktsu[bot]))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L761 | `- Sync scripts\make-changelog.ps1 ([@ktsu[bot]](https://github.com/ktsu[bot]))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L788 | `- Sync scripts\make-changelog.ps1 ([@ktsu[bot]](https://github.com/ktsu[bot]))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L796 | `- Fix typo in variable name in make-changelog.ps1 ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L801 | `- Fix typo in variable name and remove unnecessary logging in make-changelog.ps1 ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L811 | `- Add logging for note generation in MakeNotesForRange function ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L816 | `- Add changelog entry for changes since the specified tag in MakeNotesForRange function ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L821 | `- Refactor version type checks in MakeNotesForRange function and add exclusion for PowerShell files in make-version.ps1 ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L834 | `- Add VERSION_TYPE variable to MakeNotesForRange function ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L839 | `- Fix range check in MakeNotesForRange function to handle additional version format ([@matt-edmondson](https://github.com/matt-edmondson))` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/CHANGELOG.md` | L860 | `- Fix range check in MakeNotesForRange function to handle additional version format ([@matt-edmondson](https://github.com/matt-edmondson))` |

</details>

---

Let's look at the New-Changelog function in the PSBuild.psm1 file to understand how it works:

---

Read file: scripts/PSBuild.psm1

---

Let's also look at the Get-VersionNotes function since it's used to generate the content for each version:

---

<details>
            <summary>Grep search for "function Get-VersionNotes" ‚Ä¢ **1** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/scripts/PSBuild.psm1` | L631 | `function Get-VersionNotes {` |

</details>

---

Read file: scripts/PSBuild.psm1

---

Let's continue reading the rest of the function to understand the full implementation:

---

Read file: scripts/PSBuild.psm1

---

Now, I'll create a PowerShell script that modifies the changelog generation process to output the latest version's notes to a separate file. 

---

```diff
- 
+ # Extract-Latest-Changelog.ps1
+ # Script to extract the latest version's changelog to a separate file for GitHub releases
+ param(
+     [Parameter(Mandatory=$false)]
+     [string]$ChangelogPath = "CHANGELOG.md",
+     [Parameter(Mandatory=$false)]
+     [string]$OutputPath = "LATEST_CHANGELOG.md"
+ )
+ 
+ # Ensure the changelog file exists
+ if (-not (Test-Path $ChangelogPath)) {
+     Write-Error "Changelog file not found at: $ChangelogPath"
+     exit 1
+ }
+ 
+ # Read the changelog content
+ $content = Get-Content -Path $ChangelogPath -Raw
+ 
+ # Find the first two version headers (## v1.x.x)
+ $versionPattern = '##\s+v\d+\.\d+\.\d+(?:-[a-zA-Z0-9\.]+)?'
+ $matches = [regex]::Matches($content, $versionPattern)
+ 
+ if ($matches.Count -lt 1) {
+     Write-Error "Could not find any version headers in the changelog"
+     exit 1
+ }
+ 
+ # Extract content between the first and second header (or EOF if only one exists)
+ $startIndex = $matches[0].Index
+ $endIndex = if ($matches.Count -gt 1) { $matches[1].Index } else { $content.Length }
+ $latestChangelog = $content.Substring($startIndex, $endIndex - $startIndex).Trim()
+ 
+ # Write the latest changelog to the output file
+ $latestChangelog | Out-File -FilePath $OutputPath -Encoding utf8
+ 
+ Write-Output "Latest changelog extracted to: $OutputPath" 
```

---

Now, let's modify the PSBuild module to call this script after generating the full changelog. This way, it will automatically create the latest changelog whenever the full changelog is generated.

---

Cancelled

---

_**User**_

not like that, I want to edit PSBuild to handle it 

---

_**Assistant**_



---

Let me modify the PSBuild module to handle extracting the latest changelog entry. I'll update the New-Changelog function to save the latest version to a separate file.

---

```diff
      .PARAMETER IncludeAllVersions
          Whether to include all previous versions in the changelog. Defaults to $true.
+     .PARAMETER LatestChangelogPath
+         Optional path to write the latest version's changelog to. Defaults to "LATEST_CHANGELOG.md".
      #>
      [CmdletBinding()]
```

```diff
          [string]$CommitHash,
          [string]$OutputPath = "",
-         [bool]$IncludeAllVersions = $true
+         [bool]$IncludeAllVersions = $true,
+         [string]$LatestChangelogPath = "LATEST_CHANGELOG.md"
      )
  
```

```diff
      Write-Information "Generating changelog from $previousTag to $currentTag (commit: $CommitHash)" -Tags "New-Changelog"
      $versionNotes = Get-VersionNotes -Tags $tags -FromTag $previousTag -ToTag $currentTag -ToSha $CommitHash
+ 
+     # Store the latest version's notes for later use in GitHub releases
+     $latestVersionNotes = ""
  
      # If we have changes, add them to the changelog
      if (-not [string]::IsNullOrWhiteSpace($versionNotes)) {
          $changelog += $versionNotes
+         $latestVersionNotes = $versionNotes
      } else {
          # Handle no changes detected case - add a minimal entry
-         $changelog += "## $currentTag$script:lineEnding$script:lineEnding"
-         $changelog += "Initial release or no significant changes since $previousTag.$script:lineEnding$script:lineEnding"
+         $minimalEntry = "## $currentTag$script:lineEnding$script:lineEnding"
+         $minimalEntry += "Initial release or no significant changes since $previousTag.$script:lineEnding$script:lineEnding"
+         
+         $changelog += $minimalEntry
+         $latestVersionNotes = $minimalEntry
      }
  
```

```diff
  
      [System.IO.File]::WriteAllText($filePath, $changelog, [System.Text.UTF8Encoding]::new($false)) | Write-InformationStream -Tags "New-Changelog"
+ 
+     # Write latest version's changelog to separate file for GitHub releases
+     $latestPath = if ($OutputPath) { Join-Path $OutputPath $LatestChangelogPath } else { $LatestChangelogPath }
+     $latestVersionNotes = $latestVersionNotes.ReplaceLineEndings($script:lineEnding)
+     [System.IO.File]::WriteAllText($latestPath, $latestVersionNotes, [System.Text.UTF8Encoding]::new($false)) | Write-InformationStream -Tags "New-Changelog"
+     Write-Information "Latest version changelog saved to: $latestPath" -Tags "New-Changelog"
  
      $versionCount = if ($hasTags) { @($tags).Count + 1 } else { 1 }
```

---

Now, I'll update the New-GitHubRelease function to use the latest changelog file when creating releases:

---

<details>
            <summary>Grep search for "function New-GitHubRelease" ‚Ä¢ **2** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/scripts/PSBuild.psm1` | L1405 | `function New-GitHubRelease {` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/scripts/PSBuild.psm1` | L1405 | `function New-GitHubRelease {` |

</details>

---

Read file: scripts/PSBuild.psm1

---

```diff
      $releaseArgs += "--generate-notes"
  
-     # Handle changelog content if file exists
-     if (Test-Path $BuildConfiguration.ChangelogFile) {
-         Write-Information "Using changelog from $($BuildConfiguration.ChangelogFile)" -Tags "New-GitHubRelease"
+     # First check for latest changelog file (preferred for releases)
+     $latestChangelogPath = "LATEST_CHANGELOG.md"
+     if (Test-Path $latestChangelogPath) {
+         Write-Information "Using latest version changelog from $latestChangelogPath" -Tags "New-GitHubRelease"
+         $releaseArgs += "--notes-file"
+         $releaseArgs += $latestChangelogPath
+     }
+     # Fall back to full changelog if specified in config and latest not found
+     elseif (Test-Path $BuildConfiguration.ChangelogFile) {
+         Write-Information "Using full changelog from $($BuildConfiguration.ChangelogFile)" -Tags "New-GitHubRelease"
          $releaseArgs += "--notes-file"
          $releaseArgs += $BuildConfiguration.ChangelogFile
```

---

Now that we've updated both functions, let's also update the Get-BuildConfiguration function to allow specifying a custom path for the latest changelog file:

---

<details>
            <summary>Grep search for "function Get-BuildConfiguration" ‚Ä¢ **2** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/scripts/PSBuild.psm1` | L30 | `function Get-BuildConfiguration {` |
| `file:///c%3A/dev/ktsu-dev/AppDataStorage/scripts/PSBuild.psm1` | L30 | `function Get-BuildConfiguration {` |

</details>

---

Read file: scripts/PSBuild.psm1

---

```diff
      .PARAMETER ChangelogFile
          The path to the changelog file.
+     .PARAMETER LatestChangelogFile
+         The path to the file containing only the latest version's changelog. Defaults to "LATEST_CHANGELOG.md".
      .PARAMETER AssetPatterns
          Array of glob patterns for release assets.
```

```diff
          [Parameter(Mandatory=$true)]
          [string]$ChangelogFile,
+         [Parameter(Mandatory=$false)]
+         [string]$LatestChangelogFile = "LATEST_CHANGELOG.md",
          [Parameter(Mandatory=$true)]
          [string[]]$AssetPatterns
```

```diff
              ReleaseHash = $GitSha
              ChangelogFile = $ChangelogFile
+             LatestChangelogFile = $LatestChangelogFile
              AssetPatterns = $AssetPatterns
          }
```

---

Let's update the Update-ProjectMetadata function to use the LatestChangelogFile parameter when calling New-Changelog:

---

```diff
  
          Write-Information "Generating changelog..." -Tags "Update-ProjectMetadata"
-         # Fixed: Now properly includes latest changes
-         New-Changelog -Version $version -CommitHash $BuildConfiguration.ReleaseHash | Write-InformationStream -Tags "Update-ProjectMetadata"
+         # Generate both full changelog and latest version changelog
+         New-Changelog -Version $version -CommitHash $BuildConfiguration.ReleaseHash -LatestChangelogPath $BuildConfiguration.LatestChangelogFile | Write-InformationStream -Tags "Update-ProjectMetadata"
  
          # Create AUTHORS.md if authors are provided
```

```diff
              "AUTHORS.md",
              "CHANGELOG.md",
+             $BuildConfiguration.LatestChangelogFile,
              "COPYRIGHT.md",
              "PROJECT_URL.url",
```

---

Let's delete the standalone extract-latest-changelog.ps1 script since its functionality is now integrated into PSBuild:

---

Deleting the standalone script as its functionality is now integrated into the PSBuild module

---

Now, let's test our changes with a PowerShell script that demonstrates how to use these new features:

---

```diff
- 
+ # Demo script to show the usage of the updated changelog generation
+ # with automatic extraction of the latest version for GitHub releases
+ 
+ # Import PSBuild module
+ Import-Module (Join-Path $PSScriptRoot "PSBuild.psm1") -Force
+ 
+ # Set up basic configuration parameters (normally these would come from GitHub Actions)
+ $buildConfig = Get-BuildConfiguration `
+     -ServerUrl "https://github.com" `
+     -GitRef "refs/heads/main" `
+     -GitSha (git rev-parse HEAD) `
+     -GitHubOwner "ktsu-dev" `
+     -GitHubRepo "AppDataStorage" `
+     -GithubToken "dummy-token" `
+     -NuGetApiKey "dummy-key" `
+     -WorkspacePath (Get-Location) `
+     -ExpectedOwner "ktsu-dev" `
+     -ChangelogFile "CHANGELOG.md" `
+     -LatestChangelogFile "LATEST_CHANGELOG.md" `
+     -AssetPatterns @("*.nupkg", "*.zip")
+ 
+ # Generate version information based on commit history
+ $version = New-Version -CommitHash $buildConfig.Data.ReleaseHash
+ 
+ Write-Host "Generating changelog for version $version..."
+ 
+ # Generate both the full changelog and extract latest version
+ New-Changelog `
+     -Version $version `
+     -CommitHash $buildConfig.Data.ReleaseHash `
+     -LatestChangelogPath $buildConfig.Data.LatestChangelogFile
+ 
+ Write-Host "Full changelog generated: CHANGELOG.md"
+ Write-Host "Latest version changelog generated: $($buildConfig.Data.LatestChangelogFile)"
+ Write-Host ""
+ Write-Host "Latest version changelog content:"
+ Write-Host "--------------------------------"
+ Get-Content $buildConfig.Data.LatestChangelogFile
+ 
+ Write-Host ""
+ Write-Host "When creating a GitHub release, the latest version changelog will be used as the release notes."
+ Write-Host "To create a release, you would use:"
+ Write-Host "New-GitHubRelease -BuildConfiguration `$buildConfig" 
```

---

Excellent! Now let's update the README.md in the scripts directory to document the new changelog extraction feature:

---

Read file: scripts/README.md

---

```diff
  - GitHub release creation with assets
  - Proper line ending handling based on git config
+ - Automatic extraction of latest version changelog for GitHub releases
  
  ## Installation
```

```diff
      -ExpectedOwner "myorg" `
      -ChangelogFile "CHANGELOG.md" `
+     -LatestChangelogFile "LATEST_CHANGELOG.md" `
      -AssetPatterns @("staging/*.nupkg", "staging/*.zip")
  
```

```diff
  | AUTHORS.md | List of contributors from git history |
  | CHANGELOG.md | Auto-generated changelog from git history |
+ | LATEST_CHANGELOG.md | Latest version's changelog for GitHub releases |
  | PROJECT_URL.url | Link to project repository |
  | AUTHORS.url | Link to organization/owner |
+ 
+ ## Changelog Management
+ 
+ ### Full Changelog
+ 
+ The module automatically generates a comprehensive `CHANGELOG.md` file containing entries for all versions, ordered from newest to oldest. Each entry includes:
+ 
+ - Version number and type (major, minor, patch, prerelease)
+ - List of changes since the previous version
+ - Author attributions for each change
+ 
+ ### Latest Version Changelog
+ 
+ For GitHub releases, the module extracts just the latest version's changelog to a separate file (default: `LATEST_CHANGELOG.md`). This file contains only the changes for the current version, making it ideal for use as GitHub release notes.
+ 
+ When creating a GitHub release with `New-GitHubRelease`, the module automatically:
+ 
+ 1. Checks for the latest version changelog file
+ 2. Uses it as the release notes if available
+ 3. Falls back to the full changelog if necessary
+ 
+ You can customize the latest changelog file path using the `LatestChangelogFile` parameter in `Get-BuildConfiguration`.
  
  ## Version Control
```

---

I've implemented the requested feature to extract the latest version's changelog to a separate file for use in GitHub releases. Here's a summary of the changes:

1. Modified the `New-Changelog` function to extract and save the latest version notes to a separate file.
2. Updated the `Get-BuildConfiguration` function to accept a `LatestChangelogFile` parameter (defaults to "LATEST_CHANGELOG.md").
3. Enhanced the `New-GitHubRelease` function to prioritize using the latest changelog file for release notes.
4. Updated the `Update-ProjectMetadata` function to properly handle the latest changelog file.
5. Created a demo script showing how to use the feature.
6. Updated the documentation in the README.md file.

With these changes, when generating a changelog, the system will now:
1. Create the full CHANGELOG.md as before
2. Additionally extract just the latest version's entries to LATEST_CHANGELOG.md
3. Automatically use the latest changelog as the body of GitHub releases

This streamlines the release process by ensuring that only the relevant changes for the current version appear in the GitHub release description.

---

